---
title: "Contig Statistical Abundance Testing"
date: "`r Sys.Date()`"
output:
  rmdformats::html_clean:
    highlight: kate
---
```{r setup, include=FALSE}
## Global options
knitr::opts_chunk$set(cache = TRUE)

library(DESeq2)
library(tidyverse)

# define negate
'%ni%' <- Negate('%in%')

```


```{r import data}

# read in the df

coverage_df <- read.csv(file = 'corrected_coverage.tsv', sep = '\t')
colnames(coverage_df) <- gsub( "X", "", colnames(coverage_df))

# get the Patient and Dates
spl <- strsplit(as.character(colnames(coverage_df)), "_")

Patient <- sapply(spl, "[", 1)
table(Patient)
Date <- sapply(spl, "[", 2)


patients_with_multiple_samples <- names(table(Patient)[table(Patient) > 1])
total_samples_multi_patient <- sum(table(Patient)[table(Patient) > 1])


patient_788707_df <- coverage_df[,grepl("788707", colnames(coverage_df))]


```